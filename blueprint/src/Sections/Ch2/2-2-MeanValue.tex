% blueprint/src/Sections/Ch2/2-2-MeanValue.tex

\section{Mean Value Theorem}\label{sec:mean_value}

The mean value theorem and its corollary provide the analytical tools needed to 
verify contraction properties of Newton-like operators.

\begin{definition}[Operator norm]\label{def:operator_norm}
  \lean{ContinuousLinearMap.opNorm}
  \leanok
  Let $(X, \lVert \cdot\rVert_X)$ and $(Y, \lVert \cdot\rVert_Y)$ be normed linear spaces and let 
  $A: X \to Y$ be a linear map. The \textit{operator norm} on $A$ is given by
  \begin{equation*}
  \lVert A\rVert := \sup_{x \in X \setminus \{0\}} \frac{\lVert Ax\rVert_Y}{\lVert x\rVert_X} 
    = \sup_{\lVert x\rVert_X = 1} \lVert Ax\rVert_Y.
\end{equation*}
\end{definition}

\begin{proposition}[Properties of operator norm]\label{prop:operator_norm_properties}
  \lean{ContinuousLinearMap.opNorm_comp_le, ContinuousLinearMap.le_opNorm}
  \leanok
  Let $(X, \lVert \cdot\rVert)$ be a normed linear space and let $A, B: X \to X$ be linear maps. Then:
  
    (1) $\lVert Ax\rVert \leq \lVert A\rVert \lVert x\rVert$ for all $x \in X$
    (2) $\lVert AB\rVert \leq \lVert A\rVert \lVert B\rVert$ (submultiplicativity)
  
\end{proposition}

\begin{theorem}[Mean Value Theorem]\label{thm:mean_value}
  \uses{def:operator_norm}
  Suppose that $U \subset \mathbb{R}^n$ is open and that $f: U \to \mathbb{R}^n$ is $C^1$. 
  Consider $x, y \in U$ such that the line segment
  \begin{equation*}
  (1-t)x + ty, \quad t \in [0,1]
\end{equation*}
  is contained in $U$. Then,
  \begin{equation*}
  f(y) - f(x) = \left(\int_0^1 \text{Df}((1-t)x + ty) \, dt\right)(y-x),
\end{equation*}
  where $\text{Df}$ denotes the Jacobian of $f$.
\end{theorem}

\begin{corollary}[Mean Value Inequality]\label{cor:mean_value_inequality}
  \lean{Convex.norm_image_sub_le_of_norm_fderiv_le}
  \leanok
  \uses{thm:mean_value,def:operator_norm}
  Consider an open set $U \subset \mathbb{R}^n$. Let $f: U \to \mathbb{R}^n$ be a $C^1$ function. 
  Fix a point $x_0 \in U$ and assume $\overline{B}_\rho(x_0) \subset U$ for some $\rho > 0$. 
  Then, for all $x, y \in \overline{B}_\rho(x_0)$,
  \begin{equation*}
  \lVert f(y) - f(x)\rVert_\infty \leq \left(\sup_{z \in \overline{B}_\rho(x_0)} 
    \lVert \text{Df}(z)\rVert_\infty\right) \lVert y-x\rVert_\infty,
\end{equation*}
  where $\lVert \text{Df}(\cdot)\rVert_\infty$ denotes the operator norm.
\end{corollary}
