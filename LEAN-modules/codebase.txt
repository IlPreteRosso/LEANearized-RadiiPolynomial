lemma telescoping_left {X : E â†’L[â„] E} (h : â€–Xâ€– < 1) :
  (ContinuousLinearMap.id â„ E - X).comp (neumannSeriesSum h) =
  ContinuousLinearMap.id â„ E := by
  unfold neumannSeriesSum

  -- The series converges
  have h_summable := operator_series_summable_of_norm_lt_one h

  -- Strategy: Show the norm of the difference goes to zero
  suffices â€–(ContinuousLinearMap.id â„ E - X).comp (âˆ‘' n, X ^ n) - ContinuousLinearMap.id â„ Eâ€– = 0 by
    have : (ContinuousLinearMap.id â„ E - X).comp (âˆ‘' n, X ^ n) - ContinuousLinearMap.id â„ E = 0 :=
      norm_eq_zero.mp this
    exact eq_of_sub_eq_zero this

  -- The partial sums converge in norm
  have h_partial : âˆ€ Îµ > 0, âˆƒ N, âˆ€ n â‰¥ N,
    â€–(âˆ‘ k âˆˆ Finset.range n, X ^ k) - âˆ‘' k, X ^ kâ€– < Îµ := by
    intro Îµ hÎµ
    have := h_summable.hasSum.tendsto_sum_nat
    rw [Metric.tendsto_atTop] at this
    exact this Îµ hÎµ

  -- Apply finite telescoping and X^N â†’ 0
  have h_zero_lim : âˆ€ Îµ > 0, âˆƒ N, âˆ€ n â‰¥ N, â€–X ^ nâ€– < Îµ := by
    intro Îµ hÎµ
    have h_geom : Tendsto (fun n => â€–Xâ€– ^ n) atTop (ğ“ 0) :=
      tendsto_pow_atTop_nhds_zero_of_lt_one (norm_nonneg X) h
    rw [Metric.tendsto_atTop] at h_geom
    obtain âŸ¨N, hNâŸ© := h_geom Îµ hÎµ
    use N
    intro n hn
    calc â€–X ^ nâ€–
        â‰¤ â€–Xâ€– ^ n := norm_pow_le_pow_norm X n
        _ < Îµ := by simpa using hN n hn

  -- Show the composed series equals I
  rw [norm_eq_zero]

  -- For any Îµ > 0, we can make the difference small
  by_contra h_nonzero
  -- Convert negation of equality to positive norm
  have h_pos : 0 < â€–(ContinuousLinearMap.id â„ E - X).comp (âˆ‘' n, X ^ n) - ContinuousLinearMap.id â„ Eâ€– := by
    rwa [norm_pos_iff]

  -- Choose a specific Îµ to work with
  set Îµ := â€–(ContinuousLinearMap.id â„ E - X).comp (âˆ‘' n, X ^ n) - ContinuousLinearMap.id â„ Eâ€– / 3
  have hÎµ_pos : 0 < Îµ := by
    simp only [Îµ]
    apply div_pos h_pos
    norm_num

  -- Choose N large enough for both conditions
  obtain âŸ¨Nâ‚, hNâ‚âŸ© := h_partial (Îµ / max â€–ContinuousLinearMap.id â„ E - Xâ€– 1)
                                  (div_pos hÎµ_pos (lt_max_of_lt_right zero_lt_one))
  obtain âŸ¨Nâ‚‚, hNâ‚‚âŸ© := h_zero_lim Îµ hÎµ_pos

  set N := max Nâ‚ Nâ‚‚

  -- Use N to get a contradiction
  have h_approx := hNâ‚ N (le_max_left _ _)
  have h_small := hNâ‚‚ N (le_max_right _ _)

  -- Estimate using triangle inequality
  have : 3 * Îµ = â€–(ContinuousLinearMap.id â„ E - X).comp (âˆ‘' n, X ^ n) - ContinuousLinearMap.id â„ Eâ€– := by
    simp [Îµ]
    field_simp

  -- Derive the contradiction
  have h_ineq : 3 * Îµ â‰¤ 2 * Îµ := by
    calc 3 * Îµ = â€–(ContinuousLinearMap.id â„ E - X).comp (âˆ‘' n, X ^ n) - ContinuousLinearMap.id â„ Eâ€– := this
        _ â‰¤ â€–(ContinuousLinearMap.id â„ E - X).comp (âˆ‘' n, X ^ n) -
              (ContinuousLinearMap.id â„ E - X).comp (âˆ‘ n âˆˆ Finset.range N, X ^ n)â€– +
            â€–(ContinuousLinearMap.id â„ E - X).comp (âˆ‘ n âˆˆ Finset.range N, X ^ n) -
              ContinuousLinearMap.id â„ Eâ€– := by
          -- Apply triangle inequality â€–x - zâ€– â‰¤ â€–x - yâ€– + â€–y - zâ€–
          have h_tri : âˆ€ (x y z : E â†’L[â„] E), â€–x - zâ€– â‰¤ â€–x - yâ€– + â€–y - zâ€– := by
            intros x y z
            calc â€–x - zâ€– = â€–(x - y) + (y - z)â€– := by abel_nf
                  _ â‰¤ â€–x - yâ€– + â€–y - zâ€– := norm_add_le _ _
          exact h_tri _ _ _
        _ = â€–(ContinuousLinearMap.id â„ E - X).comp ((âˆ‘' n, X ^ n) - âˆ‘ n âˆˆ Finset.range N, X ^ n)â€– +
            â€–ContinuousLinearMap.id â„ E - X ^ N - ContinuousLinearMap.id â„ Eâ€– := by
          rw [â† comp_sub, finite_telescoping N]
        _ â‰¤ â€–ContinuousLinearMap.id â„ E - Xâ€– * â€–(âˆ‘' n, X ^ n) - âˆ‘ n âˆˆ Finset.range N, X ^ nâ€– +
            â€–X ^ Nâ€– := by
          gcongr
          Â· exact ContinuousLinearMap.opNorm_comp_le _ _
          Â· simp [norm_neg]
        _ â‰¤ â€–ContinuousLinearMap.id â„ E - Xâ€– * (Îµ / max â€–ContinuousLinearMap.id â„ E - Xâ€– 1) +
            Îµ := by
          gcongr
          Â· rw [norm_sub_rev]
            exact le_of_lt h_approx
        _ â‰¤ Îµ + Îµ := by
          gcongr
          -- Since â€–ContinuousLinearMap.id â„ E - Xâ€– â‰¤ max â€–ContinuousLinearMap.id â„ E - Xâ€– 1
          -- we have the desired bound directly
          calc â€–ContinuousLinearMap.id â„ E - Xâ€– * (Îµ / max â€–ContinuousLinearMap.id â„ E - Xâ€– 1)
              â‰¤ max â€–ContinuousLinearMap.id â„ E - Xâ€– 1 * (Îµ / max â€–ContinuousLinearMap.id â„ E - Xâ€– 1) := by
                gcongr
                exact le_max_left _ _
            _ = Îµ := by
              field_simp
        _ = 2 * Îµ := by ring

  -- This is impossible since Îµ > 0
  have : 3 * Îµ > 2 * Îµ := by
    calc 3 * Îµ = (2 + 1) * Îµ := by norm_num
         _ = 2 * Îµ + 1 * Îµ := by ring
         _ = 2 * Îµ + Îµ := by ring
         _ > 2 * Îµ := by linarith [hÎµ_pos]

  -- Contradiction!
  linarith [h_ineq, this]


